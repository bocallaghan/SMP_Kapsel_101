/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 * 
 * (c) Copyright 2009-2013 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.ui.core.tmpl.Template");jQuery.sap.require("sap.ui.core.library");jQuery.sap.require("sap.ui.core.Element");sap.ui.core.Element.extend("sap.ui.core.tmpl.Template",{metadata:{"abstract":true,publicMethods:["declareControl","createControl","placeAt","createMetadata","createRenderer"],library:"sap.ui.core",properties:{"content":{type:"string",group:"Data",defaultValue:null}}}});jQuery.sap.require("sap.ui.core.tmpl.TemplateControl");sap.ui.core.tmpl.Template._mSupportedTypes={};
sap.ui.core.tmpl.Template.register=function(t,c){sap.ui.core.tmpl.Template._mSupportedTypes[t]=c};
sap.ui.core.tmpl.Template.unregister=function(t){delete sap.ui.core.tmpl.Template._mSupportedTypes[t]};
sap.ui.core.tmpl.Template.parsePath=function(p){var m=undefined,s=p.indexOf(">");if(s>0){m=p.substr(0,s);p=p.substr(s+1)}return{path:p,model:m}};
sap.ui.core.tmpl.Template.prototype.init=function(s,S){if(this.getMetadata().getName()==="sap.ui.core.tmpl.Template"){throw new Error("The class 'sap.ui.core.tmpl.Template' is abstract and must not be instantiated!")}this._bComplexBindingSyntax=sap.ui.base.ManagedObject.bindingParser===sap.ui.base.BindingParser.complexParser};
sap.ui.core.tmpl.Template.prototype.extractBindingInfo=function(v,i,s){if(this._bComplexBindingSyntax){sap.ui.base.ManagedObject.bindingParser=sap.ui.base.BindingParser.simpleParser}var r=sap.ui.core.Control.prototype.extractBindingInfo.apply(this,arguments);if(this._bComplexBindingSyntax){sap.ui.base.ManagedObject.bindingParser=sap.ui.base.BindingParser.complexParser}};
sap.ui.core.tmpl.Template.prototype.render=function(c){var $=this.$(),d=$.get(0),t=d&&d.tagName.toLowerCase();if(t!=="script"&&$.parents("body").length===1){var u=this.getId()+"-uiarea",C=$.attr("data-context");c=c||C&&jQuery.parseJSON(C);$.empty().attr("id",u).removeAttr("type").show();var i=this.getId()+"-control",o=new sap.ui.core.tmpl.TemplateControl({id:i,context:c,template:this});o._renderTemplate=this.createRenderer();o.placeAt(u)}};
sap.ui.core.tmpl.Template.prototype.declareControl=function(c){if(c){var m=this.createMetadata(),r=this.createRenderer(),t=this;sap.ui.core.tmpl.TemplateControl.extend(c,{metadata:m,init:function(){sap.ui.core.tmpl.TemplateControl.prototype.init.apply(this,arguments);this.setTemplate(t)},renderer:{renderTemplate:r}});return jQuery.sap.getObject(c)}};
sap.ui.core.tmpl.Template.prototype.createControl=function(i,c){var C=new sap.ui.core.tmpl.TemplateControl({id:i,template:this,context:c});C._renderTemplate=this.createRenderer();return C};
sap.ui.core.tmpl.Template.prototype.placeAt=function(r,c,i){if(typeof c==="string"){i=c;c=undefined}var C=this.createControl(i,c);C.placeAt(r);return C};
sap.ui.core.tmpl.Template.prototype.createMetadata=function(){jQuery.sap.log.error("The function createMetadata is an abstract function which needs to be implemented by subclasses.")};
sap.ui.core.tmpl.Template.prototype.createRenderer=function(){jQuery.sap.log.error("The function createRenderer is an abstract function which needs to be implemented by subclasses.")};
sap.ui.template=function(s){if(!s){var t=[];jQuery.each(sap.ui.core.tmpl.Template._mSupportedTypes,function(T,b){jQuery("script[type='"+T+"'], [data-type='"+T+"']").each(function(f,e){t.push(sap.ui.template({id:e.id,domref:e,type:T,_class:b}))})});return t}else{if(typeof s==="string"){return sap.ui.template({id:s})}else if(s&&s.tagName&&s.nodeName&&s.ownerDocument&&s.nodeType===1){return sap.ui.template({id:s.id,domref:s})}s=jQuery.extend({type:sap.ui.core.tmpl.Template.DEFAULT_TEMPLATE},s);var i,T,c,C,r=false,l=typeof s.src==="string";if(l){var R=jQuery.sap.sjax({url:s.src,dataType:"text"});if(R.success){i=s.id,T=s.type,c=s.control,C=R.data}else{throw new Error("The template could not be loaded from "+s.src+"!")}}else{var e=s.domref||jQuery.sap.domById(s.id),$=jQuery(e);i=s.id||e&&e.id;T=$.attr("type")||s.type,c=$.attr("data-control")||s.control;if(i){var o=sap.ui.getCore().byId(i);if(!o instanceof sap.ui.core.tmpl.Template){throw new Error("Object for id \""+i+"\" is no sap.ui.core.tmpl.Template!")}else{if(o){return o}}}if($.length===0){throw new Error("DOM element for the Template with the id \""+i+"\" not found!")}C=$.html();var a=e.tagName.toLowerCase();if(a!=="script"){r=$.parents("body").length===1}}var b=s._class;if(!b){b=sap.ui.core.tmpl.Template._mSupportedTypes[T];if(!b){throw new Error("The type \""+T+"\" is not supported.")}}jQuery.sap.require(b);var d=jQuery.sap.getObject(b);var I=new d({id:i,content:C});if(c){I.declareControl(c)}if(r){I.render(s.context)}return I}};
sap.ui.core.tmpl.Template.DEFAULT_TEMPLATE="text/x-handlebars-template";sap.ui.core.tmpl.Template.register(sap.ui.core.tmpl.Template.DEFAULT_TEMPLATE,"sap.ui.core.tmpl.HandlebarsTemplate");
